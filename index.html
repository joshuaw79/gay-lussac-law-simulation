<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gay-Lussac Simulation</title>
<style>
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f0f0f0;
}

h1 {
    text-align: center;
}

#controls {
    margin: 10px;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
}

#controls input[type="number"] {
    width: 70px;
}

#simulationContainer {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    gap: 30px;
    flex-wrap: wrap;
}

canvas {
    background-color: #ffffff;
    border: 2px solid #333;
}

#pressureGauge {
    width: 300px;
    height: 25px;
    border: 1px solid #333;
    margin: 10px auto;
    background-color: #ddd;
    position: relative;
}

#pressureFill {
    height: 100%;
    width: 0;
    background-color: orange;
}

#pressureValue {
    font-weight: bold;
}

.graphContainer {
    text-align: center;
}
</style>
</head>
<body>
<h1>Gay-Lussac Simulation</h1>

<div id="controls">
    <label for="temperature">Temperature (K): </label>
    <input type="range" id="temperature" min="100" max="1000" value="300">
    <input type="number" id="tempNumber" min="100" max="1000" value="300">
    <span id="tempDisplay">300 K</span>
</div>

<div id="simulationContainer">
    <div>
        <canvas id="simulationCanvas" width="600" height="300"></canvas>
        <p>Container Volume: <span id="volumeDisplay"></span> mÂ³</p>
        <p>Pressure: <span id="pressureValue"></span> atm</p>
        <div id="pressureGauge">
            <div id="pressureFill"></div>
        </div>
    </div>

    <div class="graphContainer">
        <canvas id="graphCanvas" width="400" height="300"></canvas>
        <p><strong>Relationship between Pressure and Temperature</strong></p>
    </div>
</div>

<script>
const canvas = document.getElementById("simulationCanvas");
const ctx = canvas.getContext("2d");
const graphCanvas = document.getElementById("graphCanvas");
const graphCtx = graphCanvas.getContext("2d");

const tempSlider = document.getElementById("temperature");
const tempNumber = document.getElementById("tempNumber");
const tempDisplay = document.getElementById("tempDisplay");

const pressureFill = document.getElementById("pressureFill");
const pressureValueDisplay = document.getElementById("pressureValue");
const volumeDisplay = document.getElementById("volumeDisplay");

// Container
const containerWidthM = 1.0;
const containerHeightM = 0.5;
const containerVolume = containerWidthM * containerHeightM;
volumeDisplay.textContent = containerVolume.toFixed(2);

// Reference values
const P0 = 1.0; // atm at reference temperature
const T0 = 300; // K reference

let T = parseInt(tempSlider.value);

// Particle settings
const NUM_PARTICLES = 80;
let particles = [];

class Particle {
    constructor() {
        this.radius = 5;
        this.x = Math.random() * (canvas.width - 2 * this.radius) + this.radius;
        this.y = Math.random() * (canvas.height - 2 * this.radius) + this.radius;
        this.speed = 1;
        this.angle = Math.random() * 2 * Math.PI;
    }

    update() {
        this.x += this.speed * Math.cos(this.angle);
        this.y += this.speed * Math.sin(this.angle);
        if (this.x - this.radius < 0 || this.x + this.radius > canvas.width) this.angle = Math.PI - this.angle;
        if (this.y - this.radius < 0 || this.y + this.radius > canvas.height) this.angle = -this.angle;
    }

    draw() {
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, 2 * Math.PI);
        ctx.fillStyle = "dodgerblue";
        ctx.fill();
        ctx.strokeStyle = "black";
        ctx.stroke();
    }
}

// Initialize particles
for (let i = 0; i < NUM_PARTICLES; i++) particles.push(new Particle());

let dataPoints = []; // store P-T points for graph

function updateParticleSpeed() {
    T = parseInt(tempSlider.value);
    tempNumber.value = T;
    tempDisplay.textContent = `${T} K`;
    const baseSpeed = T / T0;
    particles.forEach(p => p.speed = baseSpeed);

    const P = P0 * (T / T0);
    pressureValueDisplay.textContent = P.toFixed(2);

    const maxTemp = 1000;
    const fillPercent = Math.min(T / maxTemp, 1) * 100;
    pressureFill.style.width = fillPercent + "%";

    // Add point to graph
    if (dataPoints.length === 0 || dataPoints[dataPoints.length - 1].T !== T) {
        dataPoints.push({T, P});
        if (dataPoints.length > 100) dataPoints.shift(); // keep last 100 points
        drawGraph();
    }
}

function drawGraph() {
    graphCtx.clearRect(0, 0, graphCanvas.width, graphCanvas.height);

    // axes
    graphCtx.beginPath();
    graphCtx.moveTo(50, 10);  // top-left margin
    graphCtx.lineTo(50, 280); // y-axis
    graphCtx.lineTo(390, 280); // x-axis
    graphCtx.strokeStyle = "#000";
    graphCtx.lineWidth = 2;
    graphCtx.stroke();

    // axis labels
    graphCtx.fillStyle = "#000";
    graphCtx.font = "14px Arial";
    // Y-axis label rotated
    graphCtx.save();
    graphCtx.translate(15, 150);
    graphCtx.rotate(-Math.PI / 2);
    graphCtx.textAlign = "center";
    graphCtx.fillText("Pressure (atm)", 0, 0);
    graphCtx.restore();
    // X-axis label
    graphCtx.textAlign = "center";
    graphCtx.fillText("Temperature (K)", 220, 295);

    // plot points
    const maxT = 1000;
    const maxP = P0 * (maxT / T0);
    graphCtx.strokeStyle = "red";
    graphCtx.fillStyle = "red";
    graphCtx.beginPath();
    dataPoints.forEach((pt, i) => {
        const x = 50 + ((pt.T - 100) / (maxT - 100)) * 340; // scaled x
        const y = 280 - (pt.P / maxP) * 270; // scaled y
        if (i === 0) graphCtx.moveTo(x, y);
        else graphCtx.lineTo(x, y);
        // small circle at point
        graphCtx.moveTo(x, y);
        graphCtx.arc(x, y, 2, 0, 2 * Math.PI);
    });
    graphCtx.stroke();
}

tempSlider.addEventListener("input", updateParticleSpeed);
tempNumber.addEventListener("input", () => {
    let val = parseInt(tempNumber.value);
    if (val < 100) val = 100;
    if (val > 1000) val = 1000;
    tempSlider.value = val;
    updateParticleSpeed();
});

function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    particles.forEach(p => { p.update(); p.draw(); });
    requestAnimationFrame(animate);
}

// Start
updateParticleSpeed();
animate();
</script>
</body>
</html>
